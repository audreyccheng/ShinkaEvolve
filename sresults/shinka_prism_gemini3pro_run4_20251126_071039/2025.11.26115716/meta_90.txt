# INDIVIDUAL PROGRAM SUMMARIES

The following are summaries of individual programs evaluated since the last meta update:

**Program Name: Sorted Greedy KV-Cache Pressure Minimization**
- **Implementation**: The algorithm sorts models in descending order by their request-rate-to-SLO ratio and assigns each to the GPU with the lowest current ratio of accumulated load to remaining memory.
- **Performance**: The solution performed effectively, achieving a combined score of 21.89 and a 100% success rate with negligible execution time.
- **Feedback**: Prioritizing models with high request density and balancing the load-to-space ratio proved to be a robust heuristic for minimizing maximum KV cache pressure without complex optimization.
**Program Identifier:** Generation 0 - Patch Name initial_program - Correct Program: True

**Program Name: Binary Search with Dynamic Linearized Sorting Key**
- **Implementation**: Uses binary search on the target pressure ratio, validating feasibility via First-Fit Decreasing sorted by a dynamic key ($Weight + K \times Size$) representing the linearized capacity constraint.
- **Performance**: Achieved a strong score of 26.23 with 100% success rate and 0.001s execution time.
- **Feedback**: The linearized sorting metric effectively adapts the heuristic to prioritize either model size or request load based on the current pressure target, yielding optimal placements efficiently.
**Program Identifier:** Generation 1 - Patch Name parametric_kvpr_search - Correct Program: True

**Program Name: Greedy Size-Density Sorted Model Placement**
- **Implementation**: The algorithm sorts models by size and request density in descending order, then greedily assigns each model to the GPU that results in the lowest local KV cache pressure after placement.
- **Performance**: The approach achieved a combined score of 20.43 with a 100% success rate, indicating strong optimization of memory pressure.
- **Feedback**: Prioritizing large, dense models prevents resource fragmentation, and the lookahead strategy for calculating resulting pressure ensures a balanced distribution of load across GPUs.
**Program Identifier:** Generation 2 - Patch Name greedy_post_placement_min_kvpr - Correct Program: True

**Program Name: Binary Search with Multi-Heuristic Bin Packing**
- **Implementation**: The algorithm minimizes maximum KV cache pressure using binary search on the target pressure value, checking feasibility via three bin packing strategies: Best Fit and First Fit on items sorted by dynamic weight ($w + K \cdot s$), and Best Fit on size-sorted items.
- **Performance**: It achieved a strong combined score of 26.23 (max KVPR 25.233) with a 100% success rate and negligible execution time (0.001s).
- **Feedback**: Employing diverse sorting and packing heuristics within the binary search allows the solver to adapt to different data distributions, effectively balancing load and escaping local optima common in single-heuristic greedy approaches.
**Program Identifier:** Generation 3 - Patch Name improved_bin_packing_heuristics - Correct Program: True

**Program Name: Hybrid Greedy and Binary Search Best-Fit Decreasing Algorithm**
- **Implementation**: This solution employs a dual strategy: a greedy heuristic that locally minimizes immediate cache pressure, and a global optimization method that uses binary search to linearize the non-linear objective function into a Best-Fit Decreasing bin packing problem.
- **Performance**: The algorithm achieved a high combined score of 26.23 with a 100% success rate and negligible execution time (0.001s).
- **Feedback**: The approach effectively solves the fractional minimization problem by transforming it into a linear constraint (`weight + K * size`), allowing standard bin packing heuristics to find near-optimal distributions where simple greedy methods might fail.
**Program Identifier:** Generation 4 - Patch Name hybrid_kvpr_optimizer - Correct Program: True

**Program Name: Greedy KVPR Minimization with Traffic Density Sorting**
- **Implementation**: The algorithm sorts models by `req_rate/slo` descending and assigns each to the GPU that results in the minimum local KV cache pressure ratio.
- **Performance**: Achieved a combined score of 22.67 with a 100% success rate and fast execution.
- **Feedback**: Sorting by request density ensures high-load models are distributed early, while the local minimization step effectively balances pressure across available resources.
**Program Identifier:** Generation 5 - Patch Name improved_greedy_placement - Correct Program: True

**Program Name:** Ensemble Greedy Heuristics for KV Cache Pressure Minimization
- **Implementation:** The algorithm executes four distinct greedy heuristics—sorting by load, size, or isolated pressure and targeting minimal current or resulting pressure—and selects the final placement that minimizes the maximum KV pressure across all GPUs.
- **Performance:** It achieved a strong combined score of 23.48 with a 100% success rate and negligible execution time.
- **Feedback:** The ensemble approach proves highly effective for this non-linear packing problem, as different heuristics (like prioritizing model size vs. request load) outperform each other depending on the specific input distribution.
**Program Identifier:** Generation 6 - Patch Name ensemble_greedy_placement - Correct Program: True

**Program Name: Ensemble Greedy Heuristics with Multiple Sorting Keys**
- **Implementation**: The algorithm tests four different greedy strategies, sorting models by weight, size, isolated pressure, and density, then assigning them to the GPU that minimizes immediate KV cache pressure. It evaluates the resulting global maximum KVPR for each strategy and returns the optimal placement configuration.
- **Performance**: The solution achieved a high combined score of 23.69 with a 100% success rate and negligible execution time.
- **Feedback**: Using an ensemble of sorting heuristics allows the algorithm to adapt to diverse model distributions, avoiding the pitfalls of a single greedy approach. This method robustly balances memory constraints against request load to effectively minimize the system-wide maximum KVPR.
**Program Identifier:** Generation 7 - Patch Name ensemble_greedy_placement - Correct Program: True

**Program Name: Binary Search with Multi-Strategy Best Fit Packing**
- **Implementation**: The algorithm minimizes maximum KV cache pressure by binary searching for a target threshold, validating feasibility via a Best Fit packing routine that rotates through multiple sorting heuristics (e.g., weighted sum, size) and randomized trials.
- **Performance**: It delivers a strong combined score of 26.26 with a perfect success rate and minimal execution overhead (0.097s).
- **Feedback**: By transforming the non-linear KVPR constraint into a linear packing problem with dynamic item weights, the approach efficiently approximates the optimal distribution, while randomized shuffling ensures robustness when deterministic heuristics fail.
**Program Identifier:** Generation 8 - Patch Name improved_heuristics_and_search - Correct Program: True

**Program Name: Hybrid Greedy and Binary Search with Local Refinement**
- **Implementation**: Utilizes a hybrid approach combining multiple greedy heuristics and binary search on KVPR targets to generate candidates, followed by local search refinement using moves and swaps to relieve the bottleneck GPU.
- **Performance**: Achieved a high combined score of 26.23 with a perfect success rate and minimal execution time (0.001s).
- **Feedback**: The strategy of diversifying initial candidates followed by targeted local optimization proves highly effective for minimizing peak memory pressure without compromising speed.
**Program Identifier:** Generation 9 - Patch Name refined_placement_heuristics_local_search - Correct Program: True

**Program Name: Multi-Heuristic Binary Search with Local Descent Optimization**
- **Implementation**: This approach utilizes binary search over the target KVPR using five distinct bin-packing heuristics (Best/First Fit with various sort keys) and refines the result with a greedy local search to offload bottleneck GPUs.
- **Performance**: Achieved a high combined score of 26.23 with 100% success rate and rapid execution (0.002s).
- **Feedback**: The combination of diverse packing strategies during the binary search phase ensures robustness, while the local optimization step effectively smooths out load imbalances left by the initial placement.
**Program Identifier:** Generation 10 - Patch Name bs_multi_heuristic_local_search - Correct Program: True

**Program Name: Hybrid Ensemble with Binary Search and Local Refinement**
- **Implementation**: The solution employs an ensemble of four greedy heuristics, a binary search over the target pressure using Best Fit Decreasing, and a local search refinement to relieve the bottleneck GPU.
- **Performance**: It achieved a high combined score of 26.23 with 100% success rate and very fast execution (0.001s).
- **Feedback**: The binary search mechanism effectively converted the non-linear min-max objective into a solvable bin-packing constraint, significantly improving load balancing compared to standalone greedy strategies.
**Program Identifier:** Generation 11 - Patch Name binary_search_and_refinement - Correct Program: True

**Program Name: Linearized Binary Search with Randomized Best-Fit and Hill-Climbing**
- **Implementation**: Solves the fractional minimization problem by binary searching for a target pressure using a linearized constraint ($w + K \cdot s \leq K \cdot C$) within a randomized Best-Fit packing routine, refined by post-allocation Hill-Climbing.
- **Performance**: Achieved an excellent combined score of 26.23 with 100% success rate and negligible execution time (0.003s).
- **Feedback**: The transformation of the fractional objective into a linear bin-packing problem allows for efficient heuristics, while the randomized restarts and local search effectively escape local optima to minimize the bottleneck.
**Program Identifier:** Generation 12 - Patch Name noisy_bfd_search_plus_repair - Correct Program: True

**Program Name: Binary Search with Linearized Beam Packing and Local Refinement**
- **Implementation**: Transforms the non-linear objective into a linearized bin packing problem solved via binary search and beam search with symmetry breaking and best-fit heuristics. A local search post-processing step actively rebalances loads to further minimize pressure and tighten search bounds.
- **Performance**: Achieved a high combined score of 26.23 with 0.006s execution time and 100% success rate.
- **Feedback**: The linearization strategy combined with symmetry-breaking beam search effectively handles the non-convex constraints, while local refinement significantly improves solution quality by aggressively lowering the maximum bottleneck.
**Program Identifier:** Generation 13 - Patch Name prism_beam - Correct Program: True

**Program Name: Hybrid Greedy Ensemble with Binary Search Bin Packing**
- **Implementation**: The algorithm employs a greedy ensemble with various sorting keys and placement strategies, coupled with a binary search that re-frames the problem as Bin Packing, and concludes with local search refinement.
- **Performance**: Achieved a combined score of 26.23 and a KVPR metric of 25.233 with a perfect success rate and minimal latency.
- **Feedback**: Transforming the non-linear objective into a bin packing feasibility check proved highly effective, allowing the use of Best Fit Decreasing to balance load better than standard greedy methods alone.
**Program Identifier:** Generation 14 - Patch Name reintroduce_binary_and_local_search - Correct Program: True

**Program Name: Binary Search Linearized Packing with Hill-Climbing Refinement**
- **Implementation**: The algorithm minimizes KV cache pressure using binary search on the pressure ratio, checking feasibility via a linearized best-fit decreasing bin packing with randomized restarts and swap-based repairs. A final hill-climbing phase applies targeted moves and swaps to relieve the highest-pressure GPU.
- **Performance**: Achieved a strong combined score of 26.23 with a 100% success rate and rapid 0.003s execution time.
- **Feedback**: The linearization of the fractional objective allows for effective standard bin packing heuristics, while the aggressive bound updates and local search refinement ensure optimal load balancing across diverse test cases.
**Program Identifier:** Generation 15 - Patch Name repair_and_tighten_bounds - Correct Program: True

**Program Name: Binary Search Bin Packing with Local Search Refinement**
- **Implementation**: The algorithm transforms the non-linear KVPR minimization into a Bin Packing feasibility problem on effective model sizes ($s + w/K$) solved via binary search, initialized by greedy heuristics and optimized with local search moves.
- **Performance**: The solution achieves a high combined score of 26.23 with a 100% success rate and low latency (0.023s).
- **Feedback**: The reduction to a standard bin packing problem allows effective optimization of the complex objective, while the multi-stage pipeline ensures both solution quality and computational efficiency.
**Program Identifier:** Generation 16 - Patch Name hybrid_placement_search - Correct Program: True

**Program Name: Hybrid Greedy Ensemble with Binary Search and Local Refinement**
- **Implementation**: The algorithm employs an ensemble of greedy strategies followed by a binary search that transforms the non-linear min-max ratio problem into a linear bin-packing feasibility check, concluding with local search moves and swaps to relieve bottleneck GPUs.
- **Performance**: It achieved a combined score of 26.23 with a 100% success rate and extremely fast execution time (0.001s).
- **Feedback**: The transformation of the objective function into a bin-packing constraint allows for effective global optimization, while the local search refinement ensures that specific high-pressure assignments are smoothed out efficiently.
**Program Identifier:** Generation 17 - Patch Name improved_local_search - Correct Program: True

**Program Name: Linearized Binary Search Packing with Repair and Local Optimization**
- **Implementation**: The algorithm linearizes the non-linear KV cache pressure objective to enable a binary search using a greedy Best-Fit strategy, augmented by a one-step swap repair mechanism for items that fail to fit. It further refines the placement using randomized noisy sorting restarts and a post-placement hill-climbing phase.
- **Performance**: The solution achieved an excellent combined score of 26.25 with a 100% success rate and extremely fast execution (0.002s).
- **Feedback**: Linearizing the cost function effectively simplifies the complex objective into a standard bin-packing constraint, allowing the binary search to converge rapidly on an optimal value. The combination of lookahead repair during packing and post-process local search provides significant robustness against local optima.
**Program Identifier:** Generation 18 - Patch Name none - Correct Program: True

**Program Name: Effective-Size Bin Packing with Ensemble Greedy and Local Search**
- **Implementation**: The solution employs a multi-strategy greedy initialization and a binary search that transforms the pressure objective into a linear bin-packing constraint ($s + w/K$), refined by bottleneck-targeted local moves and swaps.
- **Performance**: Achieved a combined score of 26.23 with a 100% success rate and exceptional speed (0.001s).
- **Feedback**: The linearization of the non-linear KVPR objective during binary search is a key optimization that, combined with local search, effectively balances memory usage and request load.
**Program Identifier:** Generation 19 - Patch Name iterative_binpack_refine - Correct Program: True

**Program Name: Beam Search with Linearized Cost and Hill Climbing**
- **Implementation**: Uses binary search to minimize max-KVPR, employing a Beam Search (width 8) with a linearized cost heuristic ($W + K \cdot S$) to check feasibility and local hill-climbing for refinement.
- **Performance**: Combined score: 0.00; Success Rate: 0.00 (failed all tests).
- **Feedback**: The zero success rate is caused by a critical `IndexError` in the beam search return statement (accessing index 2 of a length-2 tuple), causing the program to crash on every execution.
**Program Identifier:** Generation 20 - Patch Name beam_search_placement - Correct Program: False

**Program Name: Hybrid Beam Search with Binary Effective-Size Packing**
- **Implementation**: This solution combines a beam search ensemble using multiple sorting heuristics for initialization, a binary search that optimizes KVPR by transforming constraints into a bin packing problem with "effective size" ($s + w/K$), and a final local search to relieve bottleneck GPUs.
- **Performance**: Achieved a high score of 26.23 and 100% success rate with negligible execution time (0.003s), indicating excellent optimization quality and efficiency.
- **Feedback**: The binary search strategy effectively linearized the non-linear KVPR objective, allowing standard bin packing heuristics to find near-optimal distributions, while the local search refined edge cases that the packing logic missed.
**Program Identifier:** Generation 21 - Patch Name beam_search_placement - Correct Program: True

**Program Name: Hybrid Binary Search Bin Packing with Local Search Refinement**
- **Implementation**: The algorithm employs an ensemble of greedy heuristics for initialization, performs a binary search on the target KVPR by treating feasibility as a bin-packing problem, and refines the solution using iterative move and swap local search operations.
- **Performance**: Achieved a high combined score of 26.23 with a 100% success rate and negligible execution time (0.001s).
- **Feedback**: Converting the continuous min-max objective into a binary search over discrete feasibility checks proved highly effective for global optimization, while the local search phase successfully resolved remaining bottlenecks.
**Program Identifier:** Generation 22 - Patch Name bs_multisort_and_ls_swap - Correct Program: True

**Program Name: Binary Search Packing with Hill Climbing Optimization**
- **Implementation**: The algorithm uses binary search with a linearized Best Fit packing heuristic to generate an initial valid placement, followed by a local search phase that iteratively performs model moves and swaps to relieve the bottleneck GPU.
- **Performance**: Achieved a combined score of 26.26 with a fast execution time of 0.020s and a 100% success rate.
- **Feedback**: The combination of a constraint-aware global construction method and local refinement proves highly effective for the non-linear objective function, ensuring robust load balancing across GPUs.
**Program Identifier:** Generation 23 - Patch Name randomized_bs_with_local_search - Correct Program: True

**Program Name: Binary Search with Linearized Beam Packing and Local Search**
- **Implementation**: This approach binary searches for the optimal KV pressure, utilizing a beam search packer to solve the feasibility problem by linearizing capacity constraints ($w + K \cdot s \le K \cdot C$). A subsequent hill-climbing phase refines the allocation by iteratively moving or swapping models to relieve the highest-pressure GPU.
- **Performance**: The solution achieved a high score of 26.23 with a 100% success rate, balancing load effectively with negligible runtime (0.044s).
- **Feedback**: The linearization technique effectively transformed the complex non-linear objective into a manageable packing problem. Combining beam search for robust initial placement with local search for fine-tuning provided a superior balance of speed and solution quality.
**Program Identifier:** Generation 24 - Patch Name implement_beam_search - Correct Program: True

**Program Name: Binary Search with Linearized Packing and Hill Climbing**
- **Implementation**: The algorithm employs binary search on the target pressure using a linearized cost function ($w + K \cdot s$) for Best-Fit packing, augmented by a repair mechanism that swaps items to resolve placement failures. An aggressive hill-climbing optimization refines valid placements by moving items from the bottleneck GPU to tighter the upper bound dynamically.
- **Performance**: It achieves a high combined score of 26.25 with negligible execution time (0.002s) and a 100% success rate.
- **Feedback**: The combination of multiple sorting heuristics and a swap-based repair strategy ensures robustness, while the in-loop local search effectively minimizes the bottleneck beyond the precision of the binary search alone.
**Program Identifier:** Generation 25 - Patch Name hybrid_repair_search - Correct Program: True

**Program Name: Linearized Binary Search Packing with Hill Climbing**
- **Implementation**: The solution uses binary search to find the optimal maximum pressure target by transforming the non-linear objective into a linear bin-packing constraint ($w + k \cdot s$), solved via Best-Fit Decreasing. It refines the result using a greedy local search that moves or swaps models to specifically relieve the highest-pressure GPU.
- **Performance**: Achieved a high combined score of 26.23 with negligible execution time (0.003s) and perfect reliability.
- **Feedback**: Linearizing the KVPR constraint allowed standard bin-packing heuristics to find near-optimal distributions efficiently, while the targeted hill climbing effectively smoothed out remaining bottlenecks.
**Program Identifier:** Generation 26 - Patch Name hybrid_search_placement - Correct Program: True

**Program Name: Hybrid Beam Search with Bin Packing and Local Search**
- **Implementation**: The algorithm employs a symmetry-pruned Beam Search with multiple sorting heuristics and a Binary Search that transforms the pressure objective into a variable-size Bin Packing problem, followed by local Move/Swap refinement.
- **Performance**: Achieved a high combined score of 26.23 with a perfect success rate and rapid execution (0.006s).
- **Feedback**: The reduction of the min-max KVPR problem to a capacity-constrained packing problem (via Binary Search) provided excellent global bounds, while local search efficiently resolved residual bottlenecks.
**Program Identifier:** Generation 27 - Patch Name beam_search_placement - Correct Program: True

**Program Name: Hybrid Binary Search with Heuristic Packing and Local Search**
- **Implementation**: The algorithm minimizes maximum KV cache pressure by binary searching for a feasible threshold using a best-fit packing heuristic that maximizes weighted requirements, followed by a hill-climbing local search that performs model moves and swaps to relieve bottleneck GPUs.
- **Performance**: It achieved a combined score of 26.26 with a 100% success rate and a fast execution time of 0.029s.
- **Feedback**: The combination of diverse deterministic and randomized packing strategies ensures valid initial placements, while the post-processing local optimization significantly tightens the bounds, resulting in a robust and high-performing solution.
**Program Identifier:** Generation 28 - Patch Name add_local_search_refinement - Correct Program: True

**Program Name: Ensemble Greedy with Binary Search and Steepest Descent**
- **Implementation**: This solution initializes with an ensemble of greedy strategies and refines the result using a binary search on target pressure with beam search for feasibility. It concludes with a steepest descent local search that iteratively relieves the bottleneck GPU via optimal moves and swaps.
- **Performance**: The algorithm achieved a high combined score of 25.69 with a perfect success rate and a fast execution time of 0.022s.
- **Feedback**: Transforming the non-linear KVPR objective into a bin-packing feasibility problem via binary search proved highly effective. The addition of steepest descent local search ensured that the bottleneck GPU was specifically targeted for final optimization.
**Program Identifier:** Generation 29 - Patch Name bs_beam_ls_placement - Correct Program: True

**Program Name: Binary Search on Pressure with Beam Search and Local Refinement**
- **Implementation**: The algorithm linearizes the KVPR objective by binary searching on the target pressure, using beam search to verify feasibility at each step. This is augmented by an initial greedy ensemble and a final local search (moves and swaps) for optimization.
- **Performance**: Achieved a high combined score of 26.23 with 100% success rate and negligible latency (0.003s).
- **Feedback**: The approach effectively handles the non-linear objective by transforming it into a parameterized bin packing problem, efficiently balancing global search structure with local refinement.
**Program Identifier:** Generation 30 - Patch Name beam_search_placement - Correct Program: True

**Program Name: Binary Search with Ejection Chain Search**
- **Implementation**: Combines binary search on the KV pressure target with a Best Fit packing heuristic (using multiple sort keys and swap repairs) and optimizes placements using hill-climbing with ejection chains (moves, swaps, 3-cycles).
- **Performance**: Score 0.00; Max KVPR 0.000; Success Rate 0.000.
- **Feedback**: The zero success rate indicates the algorithm systematically fails to produce valid solutions, likely because the packing heuristic raises exceptions when unable to fit models into GPUs (Bin Packing failure), or due to bugs in the complex in-place state transitions.
**Program Identifier:** Generation 31 - Patch Name chain_move_placement - Correct Program: False

**Program Name: Binary Search Packing with Hill Climbing Refinement**
- **Implementation**: The algorithm minimizes maximum KV cache pressure using binary search on the target value, validated by a multi-strategy Best-Fit packing heuristic with randomized retries. It refines solutions via a hill-climbing local search that iteratively moves and swaps models from the highest-pressure GPU.
- **Performance**: The solution achieved a score of 26.26 with a 100% success rate and negligible execution time (0.030s).
- **Feedback**: Combining global search strategies (multiple sort keys) with local optimization effectively handles the non-linear cost function. The randomized restarts and specific bottleneck-targeting in the local search ensure robust and balanced resource utilization.
**Program Identifier:** Generation 32 - Patch Name add_deterministic_strategy - Correct Program: True

**Program Name: Hybrid Greedy-Beam Search with Local Refinement**
- **Implementation**: Combines multiple greedy heuristics and a binary-search-driven beam search to generate candidate placements, followed by a local search that iteratively optimizes the bottleneck GPU through model moves and swaps.
- **Performance**: Achieved a high combined score of 26.23 with 100% success rate and extremely fast execution (0.005s).
- **Feedback**: The hybrid approach effectively balances exploration (via diverse sorting keys and beam search) and exploitation (via local refinement), successfully handling the non-linear KV cache pressure constraint.
**Program Identifier:** Generation 33 - Patch Name beam_search_packing - Correct Program: True

**Program Name: Hybrid Greedy Ensemble with Binary Search and Local Refinement**
- **Implementation**: The algorithm employs an ensemble of greedy heuristics to initialize bounds, followed by a binary search on the target pressure that transforms the task into a bin packing problem with variable item sizes based on the target $K$. A final local search phase iteratively moves models from the highest-pressure GPU to others to further minimize the global maximum.
- **Performance**: The solution achieved a high combined score of 26.23 with a 100% success rate and extremely fast execution time (0.006s).
- **Feedback**: The transformation of the non-linear pressure objective into a binary search over bin packing constraints was highly effective, while the use of randomized sorting keys and local search refinements successfully mitigated local optima.
**Program Identifier:** Generation 34 - Patch Name stochastic_packing_and_swaps - Correct Program: True

**Program Name: Binary Search with Beam Packing and Local Search**
- **Implementation**: The algorithm minimizes maximum KV pressure by binary searching for a target threshold, verified via a beam search packer using linearized constraints ($w + ks \le kC$) and diverse sorting strategies. A final local search phase refines the placement by iteratively moving or swapping models to relieve the bottleneck GPU.
- **Performance**: The solution achieves a high combined score of 26.23, solving all test cases with 100% success and exceptional speed (0.017s).
- **Feedback**: Linearizing the non-linear objective function allows for efficient bin packing heuristics, while the combination of beam search and local optimization robustly balances the load across GPUs.
**Program Identifier:** Generation 35 - Patch Name beam_search_packing - Correct Program: True

**Program Name: Binary Search with Beam Feasibility and Hill Climbing**
- **Implementation**: The algorithm combines binary search on target pressure with a width-5 beam search for feasibility, utilizing a sum-of-squares heuristic and symmetry breaking. A hill-climbing refinement step optimizes bottleneck GPUs via moves and swaps to dynamically tighten the search bounds.
- **Performance**: Achieved a combined score of 26.23 with a 100% success rate and 0.001s execution time.
- **Feedback**: Updating binary search bounds with results from the local search refinement accelerates convergence, while symmetry breaking in the beam search efficiently handles the placement state space.
**Program Identifier:** Generation 36 - Patch Name beam_search_opt - Correct Program: True

**Program Name: Binary Search Packing with Linearized Cost and Local Search**
- **Implementation**: The algorithm performs a binary search on the target pressure, using a greedy packing strategy with a linearized cost function and randomized sorting to verify feasibility. A post-processing hill-climbing phase further optimizes the solution by moving or swapping models to relieve the bottleneck GPU.
- **Performance**: Achieved a high combined score of 26.26 with a 100% success rate and rapid execution time (0.029s).
- **Feedback**: The linearized heuristic (`w + k * s`) effectively adapted standard bin packing to the non-linear objective, while the local search and randomized restarts significantly improved solution quality by escaping local optima.
**Program Identifier:** Generation 37 - Patch Name binary_search_noisy_sort_hill_climbing_v2 - Correct Program: True

**Program Name: Linearized Beam Search with Steepest Descent Optimization**
- **Implementation**: This approach binary searches for the target pressure `K` by transforming the problem into a bin packing variation (`w + K*s <= K*C`) solved via Beam Search with adaptive width. A subsequent steepest descent local search iteratively swaps or moves models from the bottleneck GPU to improve the maximum pressure ratio.
- **Performance**: The algorithm achieved a high combined score of 26.26 with a fast execution time of 0.002s and a 100% success rate.
- **Feedback**: Transforming the nonlinear capacity constraint into a linear form enabled the effective use of standard packing heuristics, while the hybrid constructive and iterative approach balanced speed and solution quality effectively.
**Program Identifier:** Generation 38 - Patch Name beam_search_steepest_descent - Correct Program: True

**Program Name: Binary Search Packing with Repair and Hill Climbing Optimization**
- **Implementation**: Utilizes binary search over the KVPR target using a heuristic packing check that includes a "repair" mechanism (swapping failing items with placed ones) and randomized ordering, followed by hill-climbing post-optimization to refine moves and swaps.
- **Performance**: Achieved a high score of 26.26 with extremely fast execution (0.056s) and 100% success rate.
- **Feedback**: The repair strategy efficiently handles packing failures, while the local hill-climbing optimization significantly refines the solution quality, resulting in a robust and high-performing algorithm.
**Program Identifier:** Generation 39 - Patch Name hybrid_optimized_placement - Correct Program: True

**Program Name: Binary Search Packing with Stochastic Heuristics and Local Search**
- **Implementation**: Uses binary search on target pressure to transform the fractional objective into a linear bin packing problem, solving it via Best Fit Decreasing with multiple deterministic and stochastic sorting strategies. A final local search phase refines the placement by moving or swapping models to relieve the highest-pressure GPU.
- **Performance**: Achieved a combined score of 26.26 with a 100% success rate and extremely fast execution time (0.002s).
- **Feedback**: The linearization of the pressure metric allows effective reuse of standard bin packing heuristics, while the inclusion of randomized trials and local search ensures high-quality solutions by avoiding local optima.
**Program Identifier:** Generation 40 - Patch Name stochastic_hybrid_binpack - Correct Program: True

**Program Name: Adaptive Linearized Packing with Binary Search and Local Refinement**
- **Implementation**: The solution utilizes binary search on the max KVPR, transforming constraints into a linearized bin packing problem ($w + K \cdot s \le K \cdot C$) solved via Best Fit with an adaptive mechanism that prioritizes failed items. A Hill Climbing refinement stage subsequently optimizes the placement using move and swap operations to relieve the bottleneck GPU.
- **Performance**: The algorithm achieved a high combined score of 26.25 with a 100% success rate and extremely fast execution (0.002s).
- **Feedback**: The adaptive re-ordering strategy effectively resolves packing failures by learning from difficult items, while the linearized formulation combined with local search produces high-quality solutions with minimal computational overhead.
**Program Identifier:** Generation 41 - Patch Name adaptive_descent_packing - Correct Program: True

**Program Name: Binary Search with Multi-Heuristic Greedy and Local Search**
- **Implementation**: The algorithm minimizes maximum KV pressure using binary search on a target threshold, validating feasibility via multi-heuristic greedy bin packing (using deterministic and randomized sort keys) and refining placements with steepest descent hill climbing using move and swap operators.
- **Performance**: It achieved a high combined score of 26.26 with a 100% success rate and a fast execution time of 0.076s.
- **Feedback**: The multi-heuristic packing strategy effectively finds feasible configurations where single heuristics fail, while the local search optimization significantly reduces the bottleneck GPU load, providing a robust and efficient solution.
**Program Identifier:** Generation 42 - Patch Name hybrid_greedy_search - Correct Program: True

**Program Name: Hybrid Binary Search with Repair Packing and Local Search**
- **Implementation**: The solution minimizes KV cache pressure using binary search on a target ratio, checking feasibility via a Best-Fit packer enhanced with a "repair" mechanism that swaps conflicting items and utilizes multiple sorting heuristics. A post-processing hill-climbing stage actively refines valid placements by iteratively moving or swapping models from the bottleneck GPU to balance the load.
- **Performance**: The algorithm achieved a high combined score of 26.25 with a 100% success rate and extremely fast execution times (0.003s).
- **Feedback**: The "repair" strategy significantly improves the packer's ability to find valid configurations under tight constraints, while the local search effectively reduces peak pressure in valid solutions, highlighting the value of hybridizing construction and improvement heuristics.
**Program Identifier:** Generation 43 - Patch Name hybrid_packing_search - Correct Program: True

**Program Name: Hybrid Beam Search with Binary Search Bin Packing**
- **Implementation**: The solution integrates a symmetry-pruning beam search for initialization, a binary search over maximum pressure using multi-heuristic bin packing, and a final hill-climbing local search for refinement.
- **Performance**: It achieved a strong combined score of 26.23 with negligible execution overhead (0.004s) and perfect reliability.
- **Feedback**: Transforming the min-max pressure problem into a bin-packing feasibility check with derived constraints ($w \le K \times (C-s)$) was highly effective, yielding a robust global optimization strategy.
**Program Identifier:** Generation 44 - Patch Name hybrid_beam_binpack - Correct Program: True

**Program Name: Hybrid Bin Packing with Binary Search and Local Search**
- **Implementation**: The algorithm minimizes maximum KV cache pressure by utilizing an ensemble of greedy heuristics, a binary search that transforms the min-max problem into constrained bin packing with stochastic sorting, and a final local search to optimize bottleneck GPUs via moves and swaps.
- **Performance**: The solution achieved a high combined score of 26.26 with a 100% success rate and extremely fast execution (0.002s).
- **Feedback**: The binary search strategy effectively navigates the trade-off between model size and request rate, while the local search refinement ensures that the final placement is tightly balanced across resources.
**Program Identifier:** Generation 45 - Patch Name stochastic_bs_packing - Correct Program: True

**Program Name: Hybrid Greedy Ensemble with Randomized Binary Search and Local Search**
- **Implementation**: Combines an initial ensemble of greedy heuristics with a binary search for minimum pressure using randomized LPT packing on virtual sizes ($w + K \cdot s$), followed by steepest descent local search via moves and swaps.
- **Performance**: Achieved a high combined score of 25.66 with a perfect success rate and extremely fast execution time (0.002s).
- **Feedback**: The algorithm effectively balances speed and solution quality by using randomized restarts to escape local optima during packing and targeted local search to refine bottleneck assignments.
**Program Identifier:** Generation 46 - Patch Name stochastic_lpt_refinement - Correct Program: True

**Program Name: Binary Search with Beam Packing and Local Search Optimization**
- **Implementation**: The algorithm minimizes KV cache pressure using binary search on the target ratio, validating feasibility via a beam search bin packer with symmetry breaking on linearized costs. It refines solutions using a hill-climbing local search that applies move and swap operators to alleviate bottleneck GPUs.
- **Performance**: The approach achieved a high score of 26.23 (KVPR metric 25.23) with exceptional efficiency (0.003s execution time).
- **Feedback**: The use of symmetry breaking within the beam search allows for robust exploration without performance penalties, while the local search phase effectively fine-tunes the non-linear objective to maximize resource utilization.
**Program Identifier:** Generation 47 - Patch Name beam_search_placement - Correct Program: True

**Program Name: Binary Search with Heuristic Packing and Local Search Optimization**
- **Implementation**: The algorithm minimizes KV cache pressure using binary search on the target metric, validated by a greedy packer with multiple sorting heuristics and randomized restarts. It further optimizes the allocation using a hill-climbing local search that iteratively applies move and swap operations to relieve the bottleneck GPU.
- **Performance**: Achieved a combined score of 26.23 with a 100% success rate and fast execution time (0.045s).
- **Feedback**: The combination of global search via linearized constraints and randomized heuristics efficiently finds valid packings, while the bottleneck-targeted local search effectively balances the load across GPUs.
**Program Identifier:** Generation 48 - Patch Name noisy_sort_and_localsearch - Correct Program: True

**Program Name: Ensemble Greedy and Binary Search Bin Packing with Local Refinement**
- **Implementation**: This solution combines an ensemble of five greedy heuristics with a binary search strategy that transforms the non-linear pressure objective into a randomized bin packing problem, followed by local search refinement (moves and swaps).
- **Performance**: The algorithm achieved a high combined score of 26.26 with a 100% success rate and rapid execution time (0.047s).
- **Feedback**: Transforming the non-linear optimization goal into a linear bin packing constraint was highly effective, while the multi-stage approach provided a robust balance between initial placement speed and iterative optimization.
**Program Identifier:** Generation 49 - Patch Name fail_memory_and_swap - Correct Program: True

**Program Name: Hybrid Binary Search with Repair Packing and Hill Climbing**
- **Implementation**: The algorithm utilizes binary search on the target KVPR, validating feasibility with a "Pack with Repair" heuristic (Best-Fit Decreasing with item swaps) across multiple sorting strategies, followed by plateau-aware hill climbing to refine load balance.
- **Performance**: Achieved a high combined score of 26.25 with a Max KVPR metric of 25.255 and negligible execution time (0.005s).
- **Feedback**: The repair strategy during packing allows the greedy approach to resolve difficult placements, while the secondary hill climbing objective effectively minimizes bottleneck pressures.
**Program Identifier:** Generation 50 - Patch Name plateau_search_and_best_fit_retry - Correct Program: True

**Program Name: Binary Search with Adaptive Best-Fit and Hill Climbing Refinement**
- **Implementation**: This approach combines binary search on the target pressure with Best-Fit Decreasing bin packing, utilizing randomized retries that prioritize previously failed items. A post-processing Hill Climbing local search iteratively optimizes the placement by moving or swapping models from the bottleneck GPU.
- **Performance**: The solution achieved a strong combined score of 26.26 (KVPR metric 25.255) with a 100% success rate and minimal execution time (0.006s).
- **Feedback**: The adaptive failure prioritization effectively handles difficult packing scenarios where static heuristics fail. Coupling the binary search approximation with local search refinement ensures both feasibility and optimality in load balancing.
**Program Identifier:** Generation 51 - Patch Name adaptive_packing_with_failure_prio - Correct Program: True

**Program Name: Linearized Bin-Packing Binary Search with Local Refinement**
- **Implementation**: Converts the non-linear pressure objective into a linear bin-packing feasibility problem solved via binary search with randomized multi-strategy packing, complemented by an initial greedy ensemble and final local search refinement (move/swap).
- **Performance**: Achieves a high combined score of 26.26 with 100% success rate and exceptional speed (0.038s).
- **Feedback**: The mathematical transformation of the pressure metric into a bin-packing constraint effectively linearizes the problem, allowing standard packing heuristics to find near-optimal global solutions efficiently.
**Program Identifier:** Generation 52 - Patch Name diversify_bs_packing_and_improve_ls - Correct Program: True

**Program Name: Beam Search Packing with Binary Search and Hill Climbing**
- **Implementation**: The solution employs binary search over target pressure, using a width-8 beam search allocator with linearized cost heuristics ($w + K \cdot s$) and randomized retry strategies to find valid packings. It integrates a post-placement hill climbing phase that iteratively performs moves and swaps to aggressively minimize the bottleneck GPU's pressure.
- **Performance**: Achieved a combined score of 26.23 with a 100% success rate and an extremely fast execution time of 0.008s.
- **Feedback**: The use of beam search provides robustness against local optima during construction without the overhead of full backtracking, while the targeted hill climbing effectively refines the final solution to maximize the score.
**Program Identifier:** Generation 53 - Patch Name beam_search_packing - Correct Program: True

**Program Name: Hybrid Binary Search with Adaptive Stochastic Packing**
- **Implementation**: This approach transforms the non-linear objective into a feasibility problem ($s + w/K \leq C$) solved via binary search and stochastic bin packing with failure memory, initialized by a greedy ensemble and refined by local search.
- **Performance**: Achieved a high combined score of 26.26 with exceptional speed (0.017s) and a perfect success rate.
- **Feedback**: The transformation to a standard bin packing constraint using "effective size" was highly effective, and the failure-aware sorting mechanism significantly improved robustness during the feasibility checks without requiring heavy solvers.
**Program Identifier:** Generation 54 - Patch Name adaptive_stochastic_bin_packing_kvpr - Correct Program: True

**Program Name: Hybrid Beam Search with Randomized Effective-Size Bin Packing**
- **Implementation**: The algorithm employs a multi-phase approach starting with a heuristic beam search, followed by a binary search over the target pressure using randomized "effective size" ($s + w/K$) bin packing for feasibility checks. It concludes with a local search that performs moves and swaps to relieve the highest-pressure GPU.
- **Performance**: The solution delivers a high score of 26.26 with a 100% success rate and minimal execution time (0.014s).
- **Feedback**: Transforming the min-max objective into a bin packing feasibility check with effective sizes significantly improves packing efficiency, while stochastic retries and local search refinement ensure robust load balancing.
**Program Identifier:** Generation 55 - Patch Name optimize_beam_and_binary_search - Correct Program: True

**Program Name: Hybrid Binary Search Packing with Greedy Ensemble and Local Search**
- **Implementation**: Uses a greedy ensemble for initialization, binary search on target pressure to transform the problem into feasibility checks with stochastic bin packing, and final Move/Swap local search refinement.
- **Performance**: Achieved a high combined score of 26.23 with 100% success rate and negligible latency (0.004s).
- **Feedback**: The transformation to a feasibility problem via binary search was highly effective for the non-linear objective, while stochastic strategies and local search successfully optimized tight bottlenecks.
**Program Identifier:** Generation 56 - Patch Name kvpr_min_hybrid_search - Correct Program: True

**Program Name: Greedy Ensemble with Stochastic Binary Search and Local Refinement**
- **Implementation**: The algorithm employs an ensemble of greedy strategies, followed by a binary search that reduces the problem to stochastic bin packing using "effective size" ($s + w/K$), and finishes with local move/swap optimization.
- **Performance**: Achieved a score of 26.26 (max_kvpr metric: 25.256) with 100% success rate and 0.019s execution time.
- **Feedback**: The transformation of the non-linear pressure constraint into a linear packing problem within the binary search enabled efficient optimization, while stochastic retries effectively handled difficult edge cases.
**Program Identifier:** Generation 57 - Patch Name stochastic_failure_packing - Correct Program: True

**Program Name: Binary Search Packing with Local Search Refinement**
- **Implementation**: Uses binary search on target pressure to transform the problem into bin packing, employing multiple deterministic and stochastic sorting heuristics with failure feedback. A post-processing local search step applies moves and swaps to further reduce the maximum pressure on bottleneck GPUs.
- **Performance**: Achieved a combined score of 26.26 with a 100% success rate and fast execution time (0.006s).
- **Feedback**: The approach of converting the continuous pressure minimization into a discrete feasibility check via binary search is highly effective, while the local search significantly improves the final distribution.
**Program Identifier:** Generation 58 - Patch Name failure_driven_packing - Correct Program: True

**Program Name: Adaptive Binary Search Packing with Steepest Descent Optimization**
- **Implementation**: This solution employs binary search on the target pressure using an adaptive packing heuristic that increases weights for failed items, followed by steepest descent hill climbing to refine placements via moves and swaps.
- **Performance**: It achieved a combined score of 26.25, maintaining a 100% success rate with rapid execution (0.029s).
- **Feedback**: The adaptive reweighting strategy effectively manages hard constraints during packing, while the local search phase significantly tightens the bound on the maximum KV cache pressure.
**Program Identifier:** Generation 59 - Patch Name steepest_descent_adaptive_packing - Correct Program: True

**Program Name: Hybrid Binary Search Packing with Iterated Local Search**
- **Implementation**: The algorithm initializes via binary search over target pressure using a randomized packing heuristic with failure memory, followed by Iterated Local Search using move/swap operators. It optimizes a dual objective of maximum pressure and sum-squared pressure, employing bottleneck-targeted perturbation to escape local optima.
- **Performance**: The solution achieved a high combined score of 26.26 with negligible execution time (0.008s) and 100% success rate.
- **Feedback**: The secondary objective (sum-squared pressure) successfully breaks ties to smooth load distribution across GPUs, preventing optimization plateaus. The failure-memory mechanism during initialization ensures robust starting points, allowing the subsequent local search to converge rapidly.
**Program Identifier:** Generation 60 - Patch Name ils_kvpr_optimizer - Correct Program: True

**Program Name: Binary Search Packing with Stochastic Heuristics and Local Refinement**
- **Implementation**: Transforms the non-linear min-max pressure problem into a constrained bin packing task solved via binary search, utilizing adaptive stochastic sorting strategies and post-placement local search refinement.
- **Performance**: Achieved a high score of 26.26 with 100% success rate and minimal execution time (0.052s).
- **Feedback**: The approach effectively balances global optimization via binary search with local improvements, handling the non-linear objective function robustly through linearized constraints and stochastic retries.
**Program Identifier:** Generation 61 - Patch Name adaptive_stochastic_bin_packing - Correct Program: True

**Program Name: Hybrid Binary Search with Beam Packing and Steepest Descent**
- **Implementation**: The algorithm employs binary search on the target KVPR, validating feasibility via a hybrid strategy (multi-heuristic Greedy Best-Fit with a Beam Search fallback) and refining results using steepest descent local search to minimize the maximum load through moves and swaps.
- **Performance**: It achieved a high combined score of 26.26, maintaining a 100% success rate with extremely fast execution times (0.002s).
- **Feedback**: The combination of fast greedy heuristics with a robust beam search fallback ensures valid packings are found quickly, while the targeted local search effectively optimizes the bottleneck GPU to significantly reduce overall pressure.
**Program Identifier:** Generation 62 - Patch Name hybrid_beam_greedy - Correct Program: True

**Program Name: Hybrid Binary Search Bin Packing with Local Search Refinement**
- **Implementation**: The algorithm combines a greedy heuristic ensemble for bounding, a binary search that transforms the non-linear pressure objective into a linear Bin Packing problem using randomized Best Fit Decreasing, and a final local search to alleviate bottlenecks via moves and swaps.
- **Performance**: Achieved a combined score of 26.26 with a 100% success rate and minimal execution time (0.020s).
- **Feedback**: Converting the fractional objective into a linear bin packing constraint proved highly effective for handling the specific pressure metric, while the multi-stage strategy ensured robustness across different model distributions.
**Program Identifier:** Generation 63 - Patch Name improved_bs_and_ls - Correct Program: True

**Program Name: Stochastic Binary Search Packing with Failure Memory and Local Refinement**
- **Implementation**: Transforms the non-linear objective into a bin packing feasibility problem using binary search on "effective size," employing stochastic sorting with failure memory to prioritize difficult items and finalizing with local search (move/swap) operations.
- **Performance**: Achieves a high score of 26.26 with extremely fast execution (0.008s) and perfect reliability.
- **Feedback**: The adaptive "failure memory" mechanism significantly improves the stochastic packer's ability to handle tight constraints, while the multi-stage architecture effectively balances global search with local optimization.
**Program Identifier:** Generation 64 - Patch Name adaptive_stochastic_packer - Correct Program: True

**Program Name: Linearized Beam Search with Steepest Descent Optimization**
- **Implementation**: The algorithm employs binary search on the pressure ratio $K$, checking feasibility by transforming the problem into a linearized bin packing constraint ($w + K \cdot s \le K \cdot C$) solved via Beam Search with multiple sorting heuristics, followed by steepest descent local optimization.
- **Performance**: It achieves a high score of 26.26 with a 100% success rate and extremely fast execution (0.014s).
- **Feedback**: Transforming the rational objective into a linear constraint allows standard packing heuristics to work efficiently, while the local search effectively resolves bottleneck assignments to minimize the maximum KV cache pressure.
**Program Identifier:** Generation 65 - Patch Name multi_strat_beam_search - Correct Program: True

**Program Name: Binary Search with Multi-Heuristic Greedy and Local Search**
- **Implementation**: Uses binary search on target pressure with multiple greedy packing heuristics and a beam search fallback, followed by hill-climbing local search (move/swap) to alleviate bottleneck GPUs.
- **Performance**: Achieved a strong score of 26.23 with 100% success rate and rapid execution (0.017s).
- **Feedback**: The multi-heuristic initialization coupled with local search refinement creates a robust solver that efficiently handles diverse constraints, while the beam search fallback ensures validity in tight packing scenarios.
**Program Identifier:** Generation 66 - Patch Name beam_pressure_guided - Correct Program: True

**Program Name: Binary Search with Linearized Bin Packing and Local Search**
- **Implementation**: The algorithm minimizes maximum KV pressure by binary searching for a target ratio, transforming the non-linear constraint into a linear bin packing problem solved via Best Fit Decreasing and Beam Search. It further refines placements using steepest descent hill climbing with move and swap operators on the bottleneck GPU.
- **Performance**: It achieves a high combined score of 26.23 with a perfect success rate and negligible execution time (0.006s).
- **Feedback**: The linearization strategy effectively reduces the complex rational optimization into a solvable bin-packing variant, enabling rapid convergence via binary search. The addition of beam search and local optimization ensures robustness in finding feasible allocations where simple greedy methods fail.
**Program Identifier:** Generation 67 - Patch Name beam_search_packing - Correct Program: True

**Program Name: Hybrid Binary Search with Failure-Driven Greedy and Local Search**
- **Implementation**: The algorithm minimizes maximum KV cache pressure using binary search coupled with a hybrid packing strategy that attempts deterministic sorts before utilizing randomized, failure-driven prioritization. It includes a steepest descent local search to refine placements by moving or swapping items from bottleneck GPUs.
- **Performance**: Achieved a combined score of 26.26 with 100% success rate and extremely fast execution (0.007s).
- **Feedback**: The failure-driven heuristic efficiently handles hard-to-pack items by prioritizing them in subsequent attempts, while the linearized cost function effectively balances rate and memory constraints during packing.
**Program Identifier:** Generation 68 - Patch Name stochastic_failure_adaptive_packing - Correct Program: True

**Program Name: Hybrid Binary Search with Randomized Packing and Local Refinement**
- **Implementation**: The algorithm transforms the min-max pressure objective into a bin-packing feasibility problem solved via binary search, using randomized Best Fit heuristics with adaptive noise and failure memory, followed by local search moves and swaps to alleviate bottleneck GPUs.
- **Performance**: The solution achieved a high utility score of 26.26 with a perfect success rate and extremely fast execution time (0.038s).
- **Feedback**: The transformation to a feasibility check allows efficient exploration of the solution space, while the combination of randomized sorting strategies and local search refinement effectively prevents the solver from getting stuck in local optima.
**Program Identifier:** Generation 69 - Patch Name hybrid_packing_strategies - Correct Program: True

**Program Name: Binary Search with Multi-Heuristic Greedy and Local Search**
- **Implementation**: The solution employs binary search on the target KV pressure, utilizing a multi-heuristic greedy bin packer with failure-driven randomization to verify feasibility. Valid placements are refined via steepest descent hill climbing using move and swap operators to alleviate bottleneck GPUs.
- **Performance**: It achieved a high score of 26.25, maintaining a perfect success rate with negligible execution time (0.007s).
- **Feedback**: The combination of deterministic and adaptive randomized heuristics ensures robustness against difficult inputs, while the local search effectively fine-tunes the load balance to minimize maximum pressure.
**Program Identifier:** Generation 70 - Patch Name improved_packing_lb - Correct Program: True

**Program Name: Hybrid Bin Packing with Bottleneck Local Search**
- **Implementation**: Combines an ensemble of greedy heuristics, binary search on target pressure using randomized best-fit packing with adaptive noise, and a steepest-descent local search optimizing moves and swaps on the bottleneck GPU.
- **Performance**: Achieved a high score of 26.26 with a 100% success rate and extremely fast execution (0.047s).
- **Feedback**: The multi-stage approach effectively balances exploration via randomized packing and exploitation via local search, while the use of failure memory and adaptive noise ensures robust handling of tight memory constraints.
**Program Identifier:** Generation 71 - Patch Name steepest_descent_local_search - Correct Program: True

**Program Name: Hybrid Binary Search Bin Packing with Iterated Local Search**
- **Implementation**: Uses an ensemble of greedy heuristics and a binary search over a transformed bin-packing constraint to find initial solutions, followed by iterated local search optimizing a lexicographical objective (max pressure, sum of squared pressures).
- **Performance**: Achieved a high combined score of 26.26 with 100% success rate and very fast execution (0.051s).
- **Feedback**: Transforming the non-linear min-max objective into a linear bin-packing feasibility check via binary search proved highly effective, while the secondary sum-of-squares objective in local search ensured better load balancing.
**Program Identifier:** Generation 72 - Patch Name ils_with_secondary_obj - Correct Program: True

**Program Name: Binary Search with Linearized Best Fit and Adaptive Packing**
- **Implementation**: The algorithm employs binary search on the KVPR target, checking feasibility using a Best Fit Decreasing heuristic with a linearized cost function ($w + K \cdot s$) and an adaptive randomized strategy that prioritizes previously failed items. It further optimizes placements using steepest descent local search with move and swap operators focused on bottleneck GPUs.
- **Performance**: The approach achieved a high combined score of 26.26 with a fast execution time of 0.035s and a 100% success rate.
- **Feedback**: Transforming the non-linear KVPR constraint into a linear bin-packing problem proved highly effective for leveraging standard heuristics. The addition of a failure-aware retry mechanism significantly improved robustness by dynamically reordering difficult-to-place models.
**Program Identifier:** Generation 73 - Patch Name adaptive_failure_aware_packing - Correct Program: True

**Program Name: Hybrid Greedy Ensemble with Binary Search and Bottleneck Descent**
- **Implementation**: The algorithm employs a multi-stage pipeline starting with a greedy heuristic ensemble, followed by a binary search that transforms the pressure objective into a bin-packing feasibility check, and concludes with a steepest descent local search targeting the bottleneck GPU.
- **Performance**: The solution achieved a high combined score of 26.26 and a 100% success rate with extremely fast execution (0.020s).
- **Feedback**: The transformation of the non-linear pressure formula into a linear bin-packing constraint allows for effective global optimization, while the bottleneck-focused local search ensures precise reduction of the maximum KV pressure.
**Program Identifier:** Generation 74 - Patch Name steepest_descent_and_diverse_strategies - Correct Program: True

**Program Name: Binary Search Packing with Local Search Refinement**
- **Implementation**: The algorithm minimizes maximum pressure using binary search on a target value $K$, transforming the feasibility check into a bin packing problem (item size $w + K \cdot s$) solved via deterministic and stochastic greedy heuristics. It concludes with a local search phase that iteratively performs moves and swaps to alleviate the bottleneck GPU.
- **Performance**: The solution achieved a combined score of 26.26 with a max KVPR of 25.256 and a 100% success rate, executing in 0.022s.
- **Feedback**: The linearization of the pressure function enables efficient feasibility checks using standard packing algorithms, while the post-placement local search effectively smooths out imbalances that greedy strategies might miss.
**Program Identifier:** Generation 75 - Patch Name diversify_packing_and_deepen_search - Correct Program: True

**Program Name: Binary Search Packing with Failure-Memory and Iterated Local Search**
- **Implementation**: Employed binary search on target pressure with a randomized, failure-aware packing heuristic for initialization, followed by iterated local search using lexicographical objectives (max KVPR, sum-squared KVPR) and ruin-and-recreate perturbations.
- **Performance**: Achieved a combined score of 26.26 with a 100% success rate and 0.008s execution time.
- **Feedback**: The failure-memory packing creates a strong baseline for constrained items, while the secondary sum-squared objective in local search successfully breaks plateaus to further balance GPU loads.
**Program Identifier:** Generation 76 - Patch Name strategies_and_sa - Correct Program: True

**Program Name: Binary Search Packing with Local Search Refinement**
- **Implementation**: Uses binary search on target pressure to define variable item sizes ($w + K \cdot s$), packing via Best Fit Decreasing with multiple sorting strategies, followed by greedy local search moves and swaps.
- **Performance**: Achieved a combined score of 26.23 with 100% success rate and negligible latency (0.001s).
- **Feedback**: The hybrid approach effectively balances load by combining global feasibility checks with fine-grained local optimization, ensuring robust performance across varying constraints.
**Program Identifier:** Generation 77 - Patch Name fast_binpack_local_search - Correct Program: True

**Program Name: Adaptive Binary Search Packing with Iterated Local Search**
- **Implementation**: utilizes binary search for target pressure with an adaptive Best Fit packing heuristic that prioritizes previously failed items, followed by Iterated Local Search (moves, swaps, ruin-recreate) specifically targeting the bottleneck GPU.
- **Performance**: Achieved a high combined score of 26.17 with exceptional efficiency (0.002s execution time) and a 100% success rate.
- **Feedback**: The failure-aware sorting logic effectively resolves difficult packing constraints early, while the bottleneck-focused perturbation strategy successfully escapes local optima to minimize maximum pressure.
**Program Identifier:** Generation 78 - Patch Name adaptive_ils_placement - Correct Program: True

**Program Name: Binary Search Packing with Linearization and Adaptive Prioritization**
- **Implementation**: The solution linearizes the non-linear KVPR constraint ($W + K \cdot S \le K \cdot C$) within a binary search, using Best-Fit Decreasing with adaptive heuristics that prioritize items causing failures. A post-process hill-climbing search refines the result by moving or swapping models from the highest-pressure GPU.
- **Performance**: Achieved a high combined score of 26.26 with 100% success rate and minimal execution time (0.029s).
- **Feedback**: Linearizing the objective allowed effective use of standard bin-packing heuristics, while the adaptive failure prioritization mechanism robustly handled edge cases where simple sorting strategies failed.
**Program Identifier:** Generation 79 - Patch Name adaptive_failure_set_and_iter - Correct Program: True

**Program Name: Binary Search Bin Packing with Steepest Descent Refinement**
- **Implementation**: The algorithm minimizes maximum KV cache pressure by performing a binary search on the target pressure value, transforming the feasibility check into a bin packing problem solved via multiple deterministic and stochastic sorting heuristics. A post-processing steepest descent local search refines the result by iteratively moving or swapping models to relieve the highest-pressure GPU.
- **Performance**: The solution achieved a high combined score of 26.26 with a 100% success rate and fast execution time (0.030s).
- **Feedback**: The binary search strategy effectively linearizes the non-linear objective function, while the combination of stochastic packing and local search refinement ensures robust, high-quality load balancing across varying constraint scenarios.
**Program Identifier:** Generation 80 - Patch Name adaptive_search_and_steepest_descent - Correct Program: True

**Program Name: Hybrid Binary Search Packing with Steepest Descent Refinement**
- **Implementation**: The solution combines an initial greedy ensemble and binary search over target pressure using randomized bin packing, followed by a steepest descent local search that optimizes bottlenecks via moves and swaps.
- **Performance**: Achieved a high combined score of 26.26 and 100% success rate with a rapid execution time of 0.046s.
- **Feedback**: The transformation of the pressure minimization problem into a bin packing problem allows for effective global optimization, while the local search phase successfully fine-tunes the load balance on the bottleneck GPU.
**Program Identifier:** Generation 81 - Patch Name enhanced_bin_packing_strategies - Correct Program: True

**Program Name: Linearized Beam Search with Steepest Descent Optimization**
- **Implementation**: This approach binary searches for the optimal KV pressure, converting the problem into a linearized bin-packing task solved via adaptive beam search with multiple sorting strategies. A steepest descent local search further refines the result by iteratively targeting the bottleneck GPU.
- **Performance**: Achieved a high combined score of 26.26 with a 100% success rate and 0.007s execution time.
- **Feedback**: The transformation to linearized constraints allows efficient beam search application, while the local search effectively mitigates bin-packing fragmentation to reach near-optimal solutions.
**Program Identifier:** Generation 82 - Patch Name multi_strategy_beam_search - Correct Program: True

**Program Name: Hybrid Binary Search Packing with Local Search Refinement**
- **Implementation**: The algorithm transforms the pressure minimization problem into a bin packing feasibility check using "effective sizes" ($s + w/K$) within a binary search, supported by a stochastic packing oracle. It refines the result using aggressive local search that targets the bottleneck GPU via move and swap operations to further reduce maximum pressure.
- **Performance**: Achieved a combined score of 26.26 with a max KVPR of 25.256 and a fast execution time of 0.040s.
- **Feedback**: The transformation to a bin packing problem allows for efficient feasibility testing, while the multi-stage approach (greedy initialization, stochastic search, and local refinement) robustly escapes local optima to achieve excellent load balancing.
**Program Identifier:** Generation 83 - Patch Name stochastic_hybrid_packing - Correct Program: True

**Program Name: Binary Search with Stochastic Packing and Steepest Descent Refinement**
- **Implementation**: The algorithm minimizes maximum KV cache pressure by binary searching on a target pressure, utilizing a bin packing transformation with multiple sorting heuristics and adaptive stochastic trials. A subsequent steepest descent local search refines the solution by moving and swapping models from the highest-pressure GPU to minimize the bottleneck.
- **Performance**: It achieved a high combined score of 26.26, maintaining a 100% success rate with rapid execution (0.045s).
- **Feedback**: The strategy of linearizing the pressure constraint for bin packing allows for robust feasibility checks, while the aggressive local search refinement significantly improves the final distribution by smoothing out pressure spikes.
**Program Identifier:** Generation 84 - Patch Name optimize_binary_search_and_bounds - Correct Program: True

**Program Name: Binary Search with Linearized Packing and Integrated Local Search**
- **Implementation**: The algorithm minimizes KV pressure using binary search with a linearized cost bin packing heuristic ($w + K \cdot s$) and failure-driven randomization. It uniquely integrates Hill Climbing local search within the feasibility check to aggressively tighten the search upper bound based on actual refined placements.
- **Performance**: The solution achieved a high combined score of 26.25 (25.255 KVPR metric) with extremely fast execution (0.003s).
- **Feedback**: Embedding local search directly into the binary search update loop is a strong optimization that significantly improves the final bound compared to standard feasibility checks alone.
**Program Identifier:** Generation 85 - Patch Name adaptive_packing_search - Correct Program: True

**Program Name: Binary Search with Failure-Driven Packing and Local Search**
- **Implementation**: Combines binary search for the target KVPR with a Best Fit packing heuristic that prioritizes unplaced items on retry, supplemented by Hill Climbing (move/swap) to alleviate bottleneck GPUs.
- **Performance**: Achieved a combined score of 26.26 with 0.071s execution time, demonstrating excellent optimization quality and speed.
- **Feedback**: The approach of post-optimizing valid placements found during binary search effectively tightens the search bounds, while the failure-driven reordering ensures robust handling of difficult packing scenarios.
**Program Identifier:** Generation 86 - Patch Name failure_driven_packing_and_iterative_optimization - Correct Program: True

**Program Name: Hybrid Binary Search with Failure-Aware Stochastic Packing**
- **Implementation**: The algorithm combines deterministic greedy heuristics with a binary search for minimum pressure, utilizing a stochastic bin packing strategy that prioritizes previously failed items ("failure memory") and refines the result via local move/swap optimization.
- **Performance**: It achieves a strong score of 26.26 with minimal latency (0.040s) and 100% success rate.
- **Feedback**: The adaptive failure memory allows the packer to learn from infeasible attempts within the binary search, effectively resolving bottlenecks in tight packing scenarios without requiring exhaustive search.
**Program Identifier:** Generation 87 - Patch Name improved_bin_search_packing - Correct Program: True

**Program Name: Adaptive Binary Search Packing with Hill Climbing Refinement**
- **Implementation**: The algorithm minimizes KV cache pressure using binary search on a target threshold, validated by a Best-Fit packing strategy that adaptively prioritizes hard-to-place items, and further optimized via local search (moves and swaps).
- **Performance**: The solution achieved a strong score of 26.26 with extremely fast execution (0.032s) and perfect reliability.
- **Feedback**: The adaptive reordering of failed items during packing attempts effectively handles tight constraints, while the post-packing Hill Climbing refinement ensures the final placement is locally optimal.
**Program Identifier:** Generation 88 - Patch Name adaptive_packing_and_early_opt - Correct Program: True

**Program Name: Binary Search with Linearized Beam Packing and Steepest Descent**
- **Implementation**: The algorithm employs binary search on the objective value, transforming the rational inequality into a linearized bin packing constraint solved by a multi-heuristic Beam Search. A subsequent steepest descent local search iteratively applies the best moves or swaps to alleviate pressure on the bottleneck GPU.
- **Performance**: Achieved a combined score of 26.26 with a perfect success rate and minimal execution time (0.054s).
- **Feedback**: Linearizing the objective function allows for the effective application of standard packing heuristics, while the hybrid approach of global binary search and local refinement ensures both high solution quality and computational efficiency.
**Program Identifier:** Generation 89 - Patch Name failure_driven_packing - Correct Program: True

# GLOBAL INSIGHTS SCRATCHPAD

The following are global insights about optimization approaches and their effectiveness:

Based on the analysis of the **Current Best Program** and Generations 80-89, here are the optimization insights:

## Successful Algorithmic Patterns
- **Feedback-Driven Bound Tightening:** The **Current Best Program** and **Generation 85** utilize a critical optimization where the binary search upper bound (`high`) is updated not just to the target `mid` value, but to the *actual* maximum KVPR of the valid placement found (`high = min(mid, actual_max)`). This allows the search to "snap" to the best solution found by heuristics, drastically accelerating convergence compared to standard binary search.
- **Dynamic Constraint Linearization:** Consistently used across the highest-scoring programs (**Current Best**, **Gen 82, 89**), transforming the non-linear KVPR objective ($ \sum w / (C - \sum s) \le K $) into a linear bin-packing constraint ($ \sum w + K \sum s \le KC $). This enables standard "Best Fit" heuristics to function effectively by dynamically weighting items based on the current target pressure $K$.
- **Linearized Beam Search:** **Generation 82** achieves the top score (26.26) with exceptional speed (0.007s vs 0.097s for the Current Best) by replacing randomized trials with a deterministic Beam Search. This effectively explores the solution space of the linearized problem without the computational overhead of excessive stochastic retries.
- **Steepest Descent Refinement:** A dominant pattern in Generations **80-84** and **89**, where a post-placement local search iteratively moves or swaps models from the bottleneck GPU (highest KVPR) to others. This consistently smooths out pressure spikes that pure bin packing might miss.

## Ineffective Approaches
- **Unguided Stochastic Sampling:** While the **Current Best Program** achieves the top score, its reliance on 50 random shuffle iterations per binary search step results in significantly slower execution (0.097s) compared to deterministic approaches like **Generation 82** (0.007s). High-iteration randomization is computationally expensive relative to structured search methods (Beam Search) for this constraint type.
- **Static Heuristics without Linearization:** Early attempts in previous generations that treated weight and size independently failed to match the 26.26 score ceiling. The consistent success of Gen 80-89 confirms that heuristics must effectively combine weight and size relative to the *current* target pressure (using the $w + K \cdot s$ metric) rather than static ratios.

## Implementation Insights
- **Dual-Update Binary Search Loop:** The **Current Best Program** demonstrates a specific coding pattern where the binary search loop updates the `high` bound using the result of the placement function.
    ```python
    # From Current Best Program
    if result is not None:
        best_placement = result
        # Calculate actual max pressure of the solution found
        actual_max = ... 
        # Tighten bound aggressively
        high = min(mid, actual_max)
    ```
- **Dynamic Best-Fit Metric:** The core placement logic in the **Current Best Program** evaluates the "fit" of an item on a GPU using the linearized cost: `current_fill = new_w + k_target * new_s`. This dynamically adjusts the "size" of an item: as the target pressure $K$ increases (relaxing constraints), the physical size $s$ dominates the cost; as $K$ decreases (tight constraints), the request weight $w$ becomes more significant.
- **Failure-Memory Packing:** **Generations 86 and 87** implement "failure-driven" packing, where items that fail to fit are prioritized in subsequent attempts. This implementation detail helps resolve specific bottlenecks in tight packing scenarios more efficiently than random shuffling.

## Performance Analysis
- **Score Convergence:** Generations 80 through 89 all converged to a combined score of approximately **26.26** (Max KVPR ~25.256), indicating a hard optimization ceiling for the given dataset. The differentiation between programs is primarily in execution speed.
- **Speed vs. Strategy:** There is a significant performance divergence based on the search strategy. Programs using **Beam Search** (Gen

# META RECOMMENDATIONS

The following are actionable recommendations for the next program generations:

Based on the analysis of the **Current Best Program** and the Global Insights from Generations 80-89, here are 5 actionable recommendations for future program mutations:

1.  **Refine Solutions via Steepest Descent**
    Leverage the program's unique `high = min(mid, actual_max)` optimization by implementing a post-placement local search. Before returning a valid `placement` in `check_placement`, iteratively move or swap models from the bottleneck GPU (highest KVPR) to others to minimize its pressure. This lowers the `actual_max` drastically, allowing the binary search to tighten its upper bound much faster and reduce total iterations.

2.  **Transition to Linearized Beam Search**
    Replace the computationally expensive loop of 50 random shuffles with a deterministic **Beam Search** of moderate width (e.g., 3-5). Insights from Generation 82 show this approach achieves the same score ceiling (26.26) but reduces execution time by ~90% (0.007s vs 0.097s) by systematically exploring the decision tree of the linearized constraint ($w + K \cdot s$) rather than relying on chance.

3.  **Integrate Failure-Driven Prioritization**
    Modify the `try_pack` function to track and return the specific items that failed to fit during an invalid attempt. In subsequent iterations, explicitly move these "failed" items to the front of the processing queue. This forces the algorithm to address the most restrictive constraints immediately when the GPU bins are empty, rather than hoping a random shuffle places them favorably.

4.  **Adopt Perturbed Heuristic Sorting**
    If maintaining a stochastic approach, replace the pure `rng.shuffle(indices)` with a "noisy" sorting mechanism. Sort items by `(item['w'] + k_target * item['s']) * random.uniform(0.9, 1.1)`. This preserves the global structure of the effective "Best Fit" heuristic while introducing enough variance to escape local optima, avoiding the inefficiency of completely unguided random permutations.

5.  **Diversify Greedy Placement Strategies**
    Within the randomized or search loop, randomly toggle the inner allocation logic between "Best Fit" (minimize remaining space) and "Worst Fit" (maximize remaining space). While Best Fit minimizes fragmentation, Worst Fit balances the load across GPUs, which can be critical for preserving capacity for large-size models that appear late in the sorting order.